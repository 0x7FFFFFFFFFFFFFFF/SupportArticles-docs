---
title: Troubleshooting Jamf Pro integration with Microsoft Intune
description: Suggestions for troubleshooting some of the most common problems when you integrate Jamf Pro for Mac devices, with Microsoft Intune.
ms.date: 12/06/2021
ms.reviewer: taveil
---
# Troubleshooting integration of Jamf Pro with Microsoft Intune

This article helps Intune administrators understand and troubleshoot problems with integration of Jamf Pro for macOS with Microsoft Intune. Each of the following sections describes a common issue, and offers a potential cause and troubleshooting steps for a resolution. For help troubleshooting device registration, see [Devices fail to register with Intune through Jamf Pro](troubleshoot-jamf-device-registration.md).

## Prerequisites

Before you start troubleshooting, collect some basic information to clarify the problem and reduce the time to find a resolution. For example, when you encounter a Jamf-Intune integration-related issue, always verify that prerequisites have been met. Consider the following before you start troubleshooting:

- Review the prerequisites from the following articles, depending on how you configure Jamf Pro integration with Intune:
  - [Use the Jamf Cloud Connector to integrate Jamf Pro with Intune](/mem/intune/protect/conditional-access-jamf-cloud-connector)
  - [Integrate Jamf Pro with Intune](/mem/intune/protect/conditional-access-integrate-jamf#prerequisites)
- All users must have Microsoft Intune and Microsoft Azure Active Directory (Azure AD) Premium P1 licenses
- You must have a user account that has Microsoft Intune Integration permissions in the Jamf Pro console.
- You must have a user account that has Global Admin permissions in Azure.

Collect the following information when investigating Jamf Pro integration with Intune:

- Exact error message(s)
- Location of the error message(s)
- When the problem started, and whether your Jamf Pro integration with Intune worked previously
- How many users are affected (all users or just some)
- How many devices are affected (all devices or just some)

## Devices are marked as unresponsive in Jamf Pro  

**Cause**: The following are common causes of devices being marked as *Unresponsive* by Jamf Pro:

- Device fails to check in with Jamf Pro.  
  Jamf Pro expects devices to check in every 15 minutes. Devices are marked as unresponsive by Jamf when they fail to check in over a 24-hour period.  

- Device fails to check in with Azure AD.  
  With successful registration to Azure AD, macOS devices receive an Azure token:
  - This token refreshes every 12 hours.
  - When the token refresh fails for 24 hours or more, Jamf Pro marks the device as unresponsive.  
  - If the Azure token expires, users are prompted to sign in to Azure to obtain a new token. A refresh token for Azure access is generated every seven days.

**Solution**  
After a device is marked as *Unresponsive* by Jamf Pro, the enrolled user of the device must sign in to correct the non-responsive state. It must be the user who has workplace-joined the account as they have the identity from Intune in their keychain.

## Mac devices prompt for keychain sign-in when you open an app  

After you configure Intune and Jamf Pro integration and deploy conditional access policies, users of devices managed with Jamf Pro receive password prompts when opening Microsoft 365 applications, such as Teams, Outlook, and other apps that require Azure AD authentication.

For example, a prompt with text similar to the following example appears when opening Microsoft Teams:

> Microsoft Teams wants to sign using key "Microsoft Workplace Join Key" in your keychain.  
> To allow this, enter the "login" keychain password

**Cause**: These prompts are generated by Jamf Pro for each applicable app that requires Azure AD registration.

**Solution**  
At the prompt, the user must provide their device password to sign in to Azure AD. Options include:

- **Deny** - Do not sign in and do not use the app.
- **Allow** -  A one time sign-in. The next time the app opens, it prompts for sign-in again.
- **Always Allow** - The sign-in credentials are cached for the application. The next time the app opens, it doesn't prompt for sign-in.  

Selecting *Always Allow* for one app only approves that app for future sign-in. Additional apps prompt for authentication until they also are set as *Always Allow*. Cached credentials for one app can't be used by another app.  

## Mac device shows compliant in Intune but noncompliant in Azure  

**Cause**: The following conditions can cause a device to show as compliant in Intune but not as compliant in Azure:  

- The device isn't registered correctly.
- The device was registered multiple times without the necessary cleanup.

**Solution**  
To resolve this issue, follow the resolution for [*Cause 6*](#cause-6) for *Devices fail to register*, earlier in this article.

## Duplicate entries appear in the Intune console for Mac devices enrolled by using Jamf  

**Cause**: A device is registered with Intune multiple times, typically being re-registered after being removed from Intune.  

When a device is removed from Intune and Jamf Pro integration, some data can be left behind which can cause successive registrations to create duplicate entries.  

**Solution**  
To resolve this issue, follow the resolution for [*Cause 6*](#cause-6) for  *Devices fail to register*, earlier in this article.

## Compliance policy fails to evaluate the device  

**Cause**: Jamf integration with Intune doesn't support compliance policy that targets device groups.

**Solution**  
Modify compliance policy for macOS devices to be assigned to user groups.

## Could not retrieve the access token for Microsoft Graph API

You receive the following error:

`Could not retrieve the access token for Microsoft Graph API. Check the configuration for Microsoft Intune Integration.`

The source of this error can be one of the following causes:

### Cause 1

There's a permission issue with the Jamf Pro application in Azure. While registering the Jamf Pro app in Azure, one of the following conditions occurred:

- The app received more than one permission.
- The **Grant admin consent for *\<your company>*** option wasn't selected.  

**Solution**  
See the resolution for Cause 1 for [Devices fail to register](#devices-fail-to-register), earlier in this article.

### Cause 2

A license required for Jamf-Intune integration has expired.

**Solution**  See the resolution for Cause 3 for [Devices fail to register](#devices-fail-to-register).

### Cause 3

The required ports aren't open on your network.

**Solution**
Review the information for network ports in [Prerequisites](/mem/intune/protect/conditional-access-jamf-cloud-connector#prerequisites) for integrating Jamf Pro with Intune.
