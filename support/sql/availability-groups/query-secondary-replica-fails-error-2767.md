---
title: Query against the secondary replica fails with error 2767
description: This article provides workarounds for the issue that query against the secondary replica fails with the error 2767 "Could not locate statistics".
ms.date: 
ms.prod-support-area-path: 
ms.reviewer: 
ms.prod: sql 
---

# Query against the secondary replica fails with error 2767 "Could not locate statistics"

_Applies to:_&nbsp; SQL Server

This article provides workarounds for the issue that query against the secondary replica fails with the error 2767 "Could not locate statistics".

## Symptom

When offloading read-only workloads to a secondary replica of an Always On availability group from a primary replica, you notice that a query against the secondary replica fails with the following error message:

> Msg 2767, Level 16, State 1, Procedure sp_table_statistics2_rowset, Line *\<LineNum>* [Batch Start Line *\<LineNum>*]
>
> Could not locate statistics '_WA_Sys_00000011_37C5420D' in the system catalogs.

> [!NOTE]
> `_WA_Sys_00000011_37C5420D` is the statistics generated by a query (`AUTO_CREATE_STATISTICS` is set to on) that is running on the primary replica.

## Cause

This issue occurs for the reason that an active transaction prevents the log record of cache invalidation from accessing and refreshing the statistics on the secondary replica.

## Workaround

This problem exists in SQL Server on-premise and Azure SQL Database. To work around the issue, you can use one of the following methods as required:

- If the issue occurs in SQL Server on-premise:

    You can run the following command against the secondary replica to synchronize the cached statistics with the statistics on disk:

    ```sql
    DBCC FREESYSTEMCACHE('ALL')
    GO
    ```

- If the issue occurs in Azure SQL Database:

    You can refer to the PowerShell commands in [Invoke-AzSqlDatabaseFailover](/powershell/module/az.sql/invoke-azsqldatabasefailover) to fail over the readable secondary replica.

- If the issue occurs in SQL Server on-premise or Azure SQL Database:

    1. Determine the column that creates the query-generated statistics.

        You can run `DBCC SHOW_STATISTICS` against the primary replica by using the name of the table and statistics reported in the error 2767. Refer to the following sample:

        ```sql
        DBCC SHOW_STATISTICS('t1', '_WA_Sys_00000011_37C5420D')
        GO
        ```

        The following results display the contents of the `_WA_Sys_00000011_37C5420D` statistics in the table `t1`.

        |Name|Updated|
        |-|-|
        |`_WA_Sys_00000001_60A75C0F`|*\<DateTime>*|
        |||

        |All density|Average Length|Columns|
        |-|-|-|
        |0.5|4|c1|
        |||

    1. Drop the query-generated statistics and create permanent statistics on the primary replica.

        In this case, the statistics are created on the column `c1` of the table `t1`. You can run the following commands to drop the query-generated statistics, and then create statistics on the column `c1` of the table `t1`.

        ```sql
        DROP STATISTICS t1._WA_Sys_00000011_37C5420D
        GO
        CREATE STATISTICS t1c1 ON t1(c1)
        GO
        ```
