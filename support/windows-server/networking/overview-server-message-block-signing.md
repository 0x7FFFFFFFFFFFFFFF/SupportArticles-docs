---
title: Overview of Server Message Block signing
description: Describes how to configure SMB signing and how to determine whether SMB signing is enabled.
ms.date: 09/08/2020
author: Deland-Han
ms.author: delhan 
manager: dcscontentpm
audience: itpro
ms.topic: troubleshooting
ms.prod: windows-server
localization_priority: medium
ms.reviewer: kaushika, nedpyle
ms.prod-support-area-path: Access to remote file shares (SMB or DFS Namespace)
ms.technology: networking
---
# Overview of Server Message Block signing

This article describes Server Message Block (SMB) signing, and how to determine whether SMB signing is enabled.

_Applies to:_ &nbsp; Windows Server 2012 R2, Windows 10 - all editions  

## Introduction

SMB signing (also known as security signatures) is a security mechanism in the SMB protocol. SMB signing means every SMB 3.1.1 message contains a signature that is generated by using session key and Advanced Encryption Standard (AES). The client puts a hash of the entire message into the signature field of the SMB header.

SMB signing first appeared in Windows 2000, NT 4.0, and Windows 98. Signing algorithms have evolved over time: SMB 2.02 signing was improved with hash-based message authentication code (HMAC) SHA-256, replacing the old MD5 method from the late 1990s that was in SMB1. SMB 3.0 added AES-CMAC algorithms. In Windows Server 2022 and Windows 11, we added [AES-128-GMAC signing acceleration](https://docs.microsoft.com/windows-server/storage/file-server/smb-security#new-signing-algorithm), so if you're looking for the best performance and protection combo, consider upgrading Windows.

## How SMB signing protect the connection

If anyone changed the message during the transmission, the hash won't match, and SMB knows that someone tampered with the data. It also confirms to the sender's and the receiver's identity, breaking relay attacks. Ideally, you are using Kerberos instead of NTLMv2 so that your session key starts strong. Don't connect to shares by using IP addresses and don't use **CNAME** records. Use Kerberos instead. See [Using Computer Name Aliases in place of DNS CNAME Records](https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/using-computer-name-aliases-in-place-of-dns-cname-records/ba-p/259064) for more information.

## Policy locations for SMB signing

The policies locate under **Computer Configuration** > **Windows Settings** > **Security Settings** > **Local Policies** > **Security Options**:

- **Microsoft network client: Digitally sign communications (always)**  
  Registry key: `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManWorkstation\Parameters`  
  Registry value: **RequireSecuritySignature**  
  Data Type: REG_DWORD  
  Data: 0 (disable), 1 (enable)
- **Microsoft network client: Digitally sign communications (if server agrees)**  
  Registry key: `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManWorkstation\Parameters`  
  Registry value: **EnableSecuritySignature**  
  Data Type: REG_DWORD  
  Data: 0 (disable), 1 (enable)
- **Microsoft network server: Digitally sign communications (always)**  
  Registry key: `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters`  
  Registry value: **RequireSecuritySignature**  
  Data Type: REG_DWORD  
  Data: 0 (disable), 1 (enable)
- **Microsoft network server: Digitally sign communications (if client agrees)**  
  Registry key: `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters`  
  Registry value: **EnableSecuritySignature**  
  Data Type: REG_DWORD  
  Data: 0 (disable), 1 (enable)

In these policies, the "always" indicates the SMB signing is required to be used. The "if server agrees" or "if client agrees" indicates the SMB signing is enabled.

### Understanding "Required"

The **EnableSecuritySignature** registry setting for SMB2+ client and SMB2+ server is ignored. It does nothing at all. It is pointless unless you are using SMB1. SMB2 signing is controlled solely by being required or not. It is used when either the server or client require SMB signing. Only if they both have signing set to 0 will signing not occur. Again, SMB signing is always enabled in SMB2+.

|-|Server – RequireSecuritySignature=1|Server – RequireSecuritySignature=0|
|---|---|---|
|Client – RequireSecuritySignature=1|Signed|Signed|
|Client – RequireSecuritySignature=0|Signed|Not signed|

## Reference

[Configure SMB Signing with Confidence](https://techcommunity.microsoft.com/t5/storage-at-microsoft/configure-smb-signing-with-confidence/ba-p/2418102)

[How to Defend Users from Interception Attacks via SMB Client Defense](https://techcommunity.microsoft.com/t5/itops-talk-blog/how-to-defend-users-from-interception-attacks-via-smb-client/ba-p/1494995)

[SMB 2 and SMB 3 security in Windows 10: the anatomy of signing and cryptographic keys](/archive/blogs/openspecification/smb-2-and-smb-3-security-in-windows-10-the-anatomy-of-signing-and-cryptographic-keys)

[SMBv1 is not installed by default in Windows 10 version 1709, Windows Server version 1709 and later versions](/windows-server/storage/file-server/troubleshoot/smbv1-not-installed-by-default-in-windows)
